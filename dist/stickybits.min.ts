/**
  @preserve stickybits - Stickybits is a lightweight alternative to `position: sticky` polyfills
  @version v4.0.0
  @link https://github.com/yowainwright/stickybits#readme
  @author Jeff Wainwright <yowainwright@gmail.com> (https://jeffry.in)
  @license MIT
**/
!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?module.exports=s():"function"==typeof define&&define.amd?define(s):(t="undefined"!=typeof globalThis?globalThis:t||self).stickybits=s()}(this,function(){"use strict";class e{constructor(t,s){var s=void 0!==s?s:{},{positionVal:s,verticalPosition:e,noStyles:i,stickyBitStickyOffset:o}=(this.version="VERSION",this.userAgent=window.navigator.userAgent||"no `userAgent` provided by the browser",this.props={customStickyChangeNumber:s.customStickyChangeNumber||null,noStyles:s.noStyles||!1,stickyBitStickyOffset:s.stickyBitStickyOffset||0,parentClass:s.parentClass||"js-stickybit-parent",scrollEl:"string"==typeof s.scrollEl?document.querySelector(s.scrollEl):s.scrollEl||window,stickyClass:s.stickyClass||"js-is-sticky",stuckClass:s.stuckClass||"js-is-stuck",stickyChangeClass:s.stickyChangeClass||"js-is-sticky--change",useStickyClasses:s.useStickyClasses||!1,useFixed:s.useFixed||!1,useGetBoundingClientRect:s.useGetBoundingClientRect||!1,verticalPosition:s.verticalPosition||"top",applyStyle:s.applyStyle||((t,s)=>this.applyStyle(t,s))},this.props.positionVal=this.definePosition()||"fixed",this.instances=[],this.props),n="top"!==e||i?"":o+"px",l="fixed"!==s?s:"";this.els="string"==typeof t?document.querySelectorAll(t):t,"length"in this.els||(this.els=[this.els]);for(let t=0;t<this.els.length;t++){var a=this.els[t],a=this.addInstance(a,this.props);this.props.applyStyle({styles:{[e]:n,position:l},classes:{}},a),this.manageState(a),this.instances.push(a)}}definePosition(){let t;if(this.props.useFixed)t="fixed";else{var s=["","-o-","-webkit-","-moz-","-ms-"];const e=document.head.style;for(let t=0;t<s.length;t+=1)e.position=s[t]+"sticky";t=e.position||"fixed",e.position=""}return t}addInstance(t,s){const e={el:t,parent:t.parentNode,props:s};if("fixed"===s.positionVal||s.useStickyClasses){this.isWin=this.props.scrollEl===window;const i=this.isWin?window:this.getClosestParent(e.el,e.props.scrollEl);this.computeScrollOffsets(e),this.toggleClasses(e.parent,"",s.parentClass),e.state="default",e.stateChange="default",e.stateContainer=()=>this.manageState(e),i.addEventListener("scroll",e.stateContainer)}return e}getClosestParent(t,s){var e=s;let i=t;if(i.parentElement!==e)for(;i.parentElement!==e;)i=i.parentElement;return e}getTopPosition(t){if(this.props.useGetBoundingClientRect)return t.getBoundingClientRect().top+(this.props.scrollEl.pageYOffset||document.documentElement.scrollTop);let s=0;for(;s=t.offsetTop+s,t=t.offsetParent;);return s}computeScrollOffsets(t){const s=t;var t=s.props,e=s.el,i=s.parent,o=!this.isWin&&"fixed"===t.positionVal,n="bottom"!==t.verticalPosition,l=o?this.getTopPosition(t.scrollEl):0,a=o?this.getTopPosition(i)-l:this.getTopPosition(i),c=null!==t.customStickyChangeNumber?t.customStickyChangeNumber:e.offsetHeight,i=a+i.offsetHeight;s.offset=o?0:l+t.stickyBitStickyOffset,s.stickyStart=n?a-s.offset:0,s.stickyChange=s.stickyStart+c,s.stickyStop=n?i-(e.offsetHeight+s.offset):i-window.innerHeight}toggleClasses(t,s,e){const i=t,o=i.className.split(" ");e&&-1===o.indexOf(e)&&o.push(e),-1!==(t=o.indexOf(s))&&o.splice(t,1),i.className=o.join(" ")}manageState(e){const i=e,o=i.props;var t=i.state,s=i.stateChange,n=i.stickyStart,l=i.stickyChange,a=i.stickyStop;const c=o.positionVal;var r=o.scrollEl;const p=o.stickyClass,f=o.stickyChangeClass,u=o.stuckClass,h=o.verticalPosition;var y="bottom"!==h;const d=o.applyStyle,g=o.noStyles;const k=this.isWin&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame)||function(t){t()};var r=this.isWin?window.scrollY||window.pageYOffset:r.scrollTop,y=y&&r<=n&&("sticky"===t||"stuck"===t),m=a<=r&&"sticky"===t;n<r&&r<a&&("default"===t||"stuck"===t)?i.state="sticky":y?i.state="default":m&&(i.state="stuck");const C=l<=r&&r<=a;r<l/2||a<r?i.stateChange="default":C&&(i.stateChange="sticky"),t===i.state&&s===i.stateChange||k(()=>{const t={sticky:{styles:{position:c,top:"",bottom:"",[h]:o.stickyBitStickyOffset+"px"},classes:{[p]:!0}},default:{styles:{[h]:""},classes:{}},stuck:{styles:{[h]:"",..."fixed"===c&&!g||!this.isWin?{position:"absolute",top:"",bottom:"0"}:{}},classes:{[u]:!0}}},s=("fixed"===c&&(t.default.styles.position=""),t[i.state]);s.classes={[u]:!!s.classes[u],[p]:!!s.classes[p],[f]:C},d(s,e)})}applyStyle({styles:t,classes:s},e){const i=e.el,o=(e=e.props,i.style);var n,e=e.noStyles;const l=i.className.split(" ");for(const a in s)s[a]?-1===l.indexOf(a)&&l.push(a):-1!==(n=l.indexOf(a))&&l.splice(n,1);if(i.className=l.join(" "),t.position&&(o.position=t.position),!e)for(const c in t)o[c]=t[c]}update(e=null){return this.instances.forEach(t=>{if(this.computeScrollOffsets(t),e)for(const s in e)t.props[s]=e[s]}),this}removeInstance(t){var s=t.el,e=t.props;this.applyStyle({styles:{position:"",[e.verticalPosition]:""},classes:{[e.stickyClass]:"",[e.stuckClass]:""}},t),this.toggleClasses(s.parentNode,e.parentClass)}cleanup(){for(let t=0;t<this.instances.length;t+=1){const s=this.instances[t];s.stateContainer&&s.props.scrollEl.removeEventListener("scroll",s.stateContainer),this.removeInstance(s)}this.manageState=!1,this.instances=[]}}return function(t,s){return new e(t,s)}});
